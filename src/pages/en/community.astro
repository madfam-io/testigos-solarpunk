---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { useTranslations } from '@/i18n/config';
import MagazineCutoutImage from '../../components/MagazineCutoutImage.astro';

const lang = 'en';
const t = useTranslations(lang);
let basePath =
  import.meta.env.BASE_URL != null && import.meta.env.BASE_URL !== ''
    ? import.meta.env.BASE_URL
    : '/testigos-solarpunk';

// Ensure basePath doesn't end with a slash
if (basePath.endsWith('/')) {
  basePath = basePath.slice(0, -1);
}

// Buyer Personas - English translations
const personas = [
  {
    id: 'gaby',
    nombre: t('personas.gaby.name'),
    apodo: t('personas.gaby.nickname'),
    edad: 33,
    ocupacion: t('personas.gaby.occupation'),
    descripcion: t('personas.gaby.description'),
    dolor: t('personas.gaby.pain'),
    sketch: t('personas.gaby.sketch'),
  },
  {
    id: 'carlos',
    nombre: t('personas.carlos.name'),
    apodo: t('personas.carlos.nickname'),
    edad: 45,
    ocupacion: t('personas.carlos.occupation'),
    descripcion: t('personas.carlos.description'),
    dolor: t('personas.carlos.pain'),
    sketch: t('personas.carlos.sketch'),
  },
  {
    id: 'sofia',
    nombre: t('personas.sofia.name'),
    apodo: t('personas.sofia.nickname'),
    edad: 26,
    ocupacion: t('personas.sofia.occupation'),
    descripcion: t('personas.sofia.description'),
    dolor: t('personas.sofia.pain'),
    sketch: t('personas.sofia.sketch'),
  },
  {
    id: 'miguel',
    nombre: t('personas.miguel.name'),
    apodo: t('personas.miguel.nickname'),
    edad: 19,
    ocupacion: t('personas.miguel.occupation'),
    descripcion: t('personas.miguel.description'),
    dolor: t('personas.miguel.pain'),
    sketch: t('personas.miguel.sketch'),
  },
  {
    id: 'laura',
    nombre: t('personas.laura.name'),
    apodo: t('personas.laura.nickname'),
    edad: 38,
    ocupacion: t('personas.laura.occupation'),
    descripcion: t('personas.laura.description'),
    dolor: t('personas.laura.pain'),
    sketch: t('personas.laura.sketch'),
  },
];

// Pain Points - English translations
const painPoints = [
  {
    tipo: 'economica',
    titulo: t('barriers.economic.title'),
    creencia: t('barriers.economic.belief'),
    solucion: t('barriers.economic.solution'),
    icon: 'üí∞',
  },
  {
    tipo: 'educativa',
    titulo: t('barriers.educational.title'),
    creencia: t('barriers.educational.belief'),
    solucion: t('barriers.educational.solution'),
    icon: 'üìö',
  },
  {
    tipo: 'cultural',
    titulo: t('barriers.cultural.title'),
    creencia: t('barriers.cultural.belief'),
    solucion: t('barriers.cultural.solution'),
    icon: 'üé≠',
  },
  {
    tipo: 'tiempo',
    titulo: t('barriers.time.title'),
    creencia: t('barriers.time.belief'),
    solucion: t('barriers.time.solution'),
    icon: '‚è±Ô∏è',
  },
];
---

<BaseLayout
  lang={lang}
  title={t('community.title')}
  description={t('community.description')}
>
  <section class="hero-comunidad">
    <div class="container">
      <h1>{t('community.hero.title')}</h1>
      <p class="hero-description">
        {
          t('community.hero.description') !== ''
            ? t('community.hero.description')
            : 'Meet the people who need to hear the sustainable message'
        }
      </p>
    </div>
  </section>

  <section class="personas-section newspaper-bg with-columns">
    <div class="container">
      <h2>{t('community.personas.title')}</h2>
      <p class="section-intro">
        {t('community.personas.intro')}
      </p>

      <div class="personas-grid">
        {
          personas.map((persona) => (
            <article class="magazine-card card-lg theme-community interactive">
              <div class="persona-header">
                <div class="persona-avatar">
                  <MagazineCutoutImage
                    alt={`Avatar of ${persona.nombre} (${persona.apodo})`}
                    width={120}
                    height={120}
                    type="character"
                    prompt={`portrait of ${persona.nombre}, ${persona.ocupacion}, ${persona.apodo}, age ${persona.edad}`}
                    cutoutStyle="emoji-lg"
                    theme="community"
                    context="card"
                    interactive={true}
                    class="persona-image"
                  />
                </div>
                <div class="persona-info">
                  <h3>{persona.nombre}</h3>
                  <p class="persona-apodo">"{persona.apodo}"</p>
                  <p class="persona-edad">
                    {persona.edad} {t('ui.age')} ‚Ä¢ {persona.ocupacion}
                  </p>
                </div>
              </div>

              <div class="persona-content">
                <p class="persona-descripcion">{persona.descripcion}</p>

                <div class="persona-dolor">
                  <span class="dolor-label">{t('ui.pain.label')}</span>
                  <p>{persona.dolor}</p>
                </div>

                <div class="persona-sketch">
                  <span class="sketch-label">{t('ui.sketch.label')}</span>
                  <a
                    href={`${basePath}/en/content/sketches`}
                    class="sketch-link"
                  >
                    <span class="emoji-cutout emoji-sm theme-solar">üé¨</span>{' '}
                    {persona.sketch}
                  </a>
                </div>
              </div>
            </article>
          ))
        }
      </div>
    </div>
  </section>

  <section class="pain-points-section newspaper-bg aged">
    <div class="container">
      <h2>{t('community.barriers.title')}</h2>
      <p class="section-intro">
        {t('community.barriers.intro')}
      </p>

      <div class="barriers-grid">
        {
          painPoints.map((point) => (
            <div class="magazine-card card-md theme-green interactive">
              <span class="barrier-icon">
                <span class="emoji-cutout emoji-lg theme-community flutter">
                  {point.icon}
                </span>
              </span>
              <h3>{point.titulo}</h3>
              <p class="barrier-creencia">{point.creencia}</p>
              <div class="barrier-solution">
                <span class="solution-label">{t('ui.solution.label')}</span>
                <p>{point.solucion}</p>
              </div>
            </div>
          ))
        }
      </div>
    </div>
  </section>

  <section class="community-values">
    <div class="container">
      <h2>{t('community.values.title')}</h2>
      <div class="values-grid">
        <div
          class="magazine-card card-md theme-solar interactive context-feature"
        >
          <span class="value-icon"
            ><span class="emoji-cutout emoji-lg theme-community interactive"
              >ü§ù</span
            ></span
          >
          <h3>{t('values.inclusion.title')}</h3>
          <p>{t('values.inclusion.description')}</p>
        </div>
        <div
          class="magazine-card card-md theme-solar interactive context-feature"
        >
          <span class="value-icon"
            ><span class="emoji-cutout emoji-lg theme-solar interactive"
              >üòÑ</span
            ></span
          >
          <h3>{t('values.humor.title')}</h3>
          <p>{t('values.humor.description')}</p>
        </div>
        <div
          class="magazine-card card-md theme-solar interactive context-feature"
        >
          <span class="value-icon"
            ><span class="emoji-cutout emoji-lg theme-green interactive"
              >üå±</span
            ></span
          >
          <h3>{t('values.action.title')}</h3>
          <p>{t('values.action.description')}</p>
        </div>
        <div
          class="magazine-card card-md theme-solar interactive context-feature"
        >
          <span class="value-icon"
            ><span class="emoji-cutout emoji-lg theme-purple interactive"
              >üí°</span
            ></span
          >
          <h3>{t('values.creativity.title')}</h3>
          <p>{t('values.creativity.description')}</p>
        </div>
      </div>
    </div>
  </section>

  <section class="join-community">
    <div class="container">
      <h2>{t('community.participation.title')}</h2>
      <div class="join-options">
        <div
          class="magazine-card card-md theme-community interactive context-feature"
        >
          <h3>
            <span class="emoji-cutout emoji-md theme-solar">üé¨</span>
            {t('participation.create.title')}
          </h3>
          <p>{t('participation.create.description')}</p>
          <button class="btn btn-secondary"
            >{t('participation.create.cta')}</button
          >
        </div>
        <div
          class="magazine-card card-md theme-community interactive context-feature"
        >
          <h3>
            <span class="emoji-cutout emoji-md theme-purple">üì§</span>
            {t('participation.share.title')}
          </h3>
          <p>{t('participation.share.description')}</p>
          <button class="btn btn-secondary"
            >{t('participation.share.cta')}</button
          >
        </div>
        <div
          class="magazine-card card-md theme-community interactive context-feature"
        >
          <h3>
            <span class="emoji-cutout emoji-md theme-community">ü§ù</span>
            {t('participation.collaborate.title')}
          </h3>
          <p>{t('participation.collaborate.description')}</p>
          <button class="btn btn-secondary"
            >{t('participation.collaborate.cta')}</button
          >
        </div>
        <div
          class="magazine-card card-md theme-community interactive context-feature"
        >
          <h3>
            <span class="emoji-cutout emoji-md theme-green">üíö</span>
            {t('participation.sponsor.title')}
          </h3>
          <p>{t('participation.sponsor.description')}</p>
          <a
            href={`${basePath}/en/resources#sponsors`}
            class="btn btn-secondary"
          >
            {t('participation.sponsor.cta')}
          </a>
        </div>
      </div>
    </div>
  </section>

  <section class="community-cta">
    <div class="container">
      <div class="cta-content">
        <h2>{t('community.cta.title')}</h2>
        <p>{t('community.cta.subtitle')}</p>

        <div class="social-links">
          <a
            href="https://instagram.com/testigosdesolarpunk"
            class="social-link"
            aria-label={t("social.instagram")}
            target="_blank"
            rel="noopener noreferrer"
          >
            <span class="emoji-cutout emoji-md theme-purple interactive"
              >üì∑</span
            >
          </a>
          <a
            href="https://tiktok.com/@testigosdesolarpunk"
            class="social-link"
            aria-label={t("social.tiktok")}
            target="_blank"
            rel="noopener noreferrer"
          >
            <span class="emoji-cutout emoji-md theme-solar interactive">üéµ</span
            >
          </a>
          <a
            href="https://youtube.com/@testigosdesolarpunk"
            class="social-link"
            aria-label={t("social.youtube")}
            target="_blank"
            rel="noopener noreferrer"
          >
            <span class="emoji-cutout emoji-md theme-community interactive"
              >üì∫</span
            >
          </a>
          <a
            href="https://twitter.com/testigossolarpk"
            class="social-link"
            aria-label={t("social.twitter")}
            target="_blank"
            rel="noopener noreferrer"
          >
            <span class="emoji-cutout emoji-md theme-purple interactive"
              >üê¶</span
            >
          </a>
        </div>

        <div class="magazine-card card-lg theme-tech interactive">
          <h3>{t('community.newsletter.title')}</h3>
          <form enctype="application/x-www-form-urlencoded">
            <input
              type="email"
              placeholder={t('form.email')}
              class="email-input"
              required
              aria-required="true"
              aria-label={t('aria.email.newsletter') !== ''
                ? t('aria.email.newsletter')
                : 'Email for newsletter'}
            />
            <button type="submit" class="btn btn-primary"
              >{t('ui.subscribe')}</button
            >
          </form>
        </div>
      </div>
    </div>
  </section>
</BaseLayout>

<style>
  .hero-comunidad {
    background: linear-gradient(
      135deg,
      var(--naranja-comunidad) 0%,
      rgba(255, 111, 53, 0.2) 100%
    );
    padding: var(--espacio-xxl) 0;
    text-align: center;
    color: var(--text-on-accent, #000000);
  }

  .hero-comunidad h1 {
    font-size: 3rem;
    margin-bottom: var(--espacio-md);
  }

  .hero-description {
    font-size: 1.2rem;
    max-width: 600px;
    margin: 0 auto;
    opacity: 0.9;
  }

  /* Personas Section */
  .personas-section {
    padding: var(--espacio-xxl) 0;
  }

  .personas-section h2,
  .pain-points-section h2,
  .community-values h2,
  .join-community h2 {
    text-align: center;
    font-size: 2.5rem;
    margin-bottom: var(--espacio-md);
    color: #2c2c2c;
    text-shadow: 1px 1px 2px rgba(255, 255, 255, 0.8);
  }

  .section-intro {
    text-align: center;
    font-size: 1.1rem;
    color: #4a4a4a;
    margin-bottom: var(--espacio-xl);
    text-shadow: 1px 1px 2px var(--text-tertiary);
  }

  .personas-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
    gap: var(--espacio-xl);
  }

  .persona-header {
    display: flex;
    gap: var(--espacio-md);
    margin-bottom: var(--espacio-lg);
  }

  .persona-avatar {
    width: 80px;
    height: 80px;
    overflow: hidden;
    background: var(--fondo-secundario);
    flex-shrink: 0;
    /* Magazine cutout portrait style */
    clip-path: polygon(
      15% 0%,
      85% 3%,
      100% 15%,
      98% 85%,
      85% 100%,
      15% 97%,
      0% 85%,
      2% 15%
    );
    transform: rotate(-3deg);
    filter: drop-shadow(2px 2px 3px var(--cutout-shadow-dark));
    position: relative;
  }

  .persona-info h3 {
    margin-bottom: var(--espacio-xs);
    color: var(--texto-primario);
  }

  .persona-apodo {
    color: var(--naranja-comunidad);
    font-style: italic;
    margin-bottom: var(--espacio-xs);
  }

  .persona-edad {
    font-size: 0.9rem;
    color: var(--texto-secundario);
  }

  .persona-descripcion {
    margin-bottom: var(--espacio-md);
    line-height: 1.6;
  }

  .persona-dolor,
  .persona-sketch {
    padding: var(--espacio-md);
    background: var(--fondo-secundario);
    border-radius: 8px;
    margin-bottom: var(--espacio-sm);
  }

  .dolor-label,
  .sketch-label {
    font-weight: 600;
    color: var(--texto-primario);
    display: block;
    margin-bottom: var(--espacio-xs);
  }

  .sketch-link {
    color: var(--amarillo-solar);
    text-decoration: none;
    font-weight: 500;
  }

  .sketch-link:hover {
    text-decoration: underline;
  }

  /* Pain Points */
  .pain-points-section {
    padding: var(--espacio-xxl) 0;
  }

  .barriers-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: var(--espacio-xl);
  }

  .barriers-grid {
    text-align: center;
  }

  .barrier-icon {
    font-size: 3rem;
    display: block;
    margin-bottom: var(--espacio-md);
  }

  .barrier-creencia {
    font-size: 1.1rem;
    color: var(--texto-secundario);
    font-style: italic;
    margin-bottom: var(--espacio-lg);
  }

  .barrier-solution {
    padding-top: var(--espacio-md);
    border-top: 1px solid var(--borde-claro);
  }

  .solution-label {
    font-weight: 600;
    color: var(--verde-sostenible);
    display: block;
    margin-bottom: var(--espacio-xs);
  }

  /* Values */
  .community-values {
    padding: var(--espacio-xxl) 0;
    background: var(--fondo-secundario);
  }

  .values-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: var(--espacio-xl);
    max-width: 1000px;
    margin: 0 auto;
  }

  .value-icon {
    font-size: 3rem;
    display: block;
    margin-bottom: var(--espacio-md);
  }

  /* Join Options */
  .join-community {
    padding: var(--espacio-xxl) 0;
  }

  .join-options {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: var(--espacio-xl);
  }

  /* CTA Section */
  .community-cta {
    background: linear-gradient(
      135deg,
      var(--fondo-primario) 0%,
      rgba(255, 111, 53, 0.05) 100%
    );
    padding: var(--espacio-xxl) 0;
  }

  .community-cta .cta-content {
    text-align: center;
    max-width: 600px;
    margin: 0 auto;
  }

  .community-cta h2 {
    font-size: 2.5rem;
    margin-bottom: var(--espacio-md);
  }

  .community-cta p {
    font-size: 1.2rem;
    color: var(--texto-secundario);
    margin-bottom: var(--espacio-xl);
  }

  .social-links {
    display: flex;
    justify-content: center;
    gap: var(--espacio-md);
    margin-bottom: var(--espacio-xl);
  }

  .social-link {
    width: 60px;
    height: 60px;
    background: var(--bg-secondary, #1a1a1b);
    color: var(--text-primary, #ffffff);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.5rem;
    text-decoration: none;
    border: 1px solid var(--border-subtle, rgba(255, 255, 255, 0.1));
    box-shadow: 0 4px 6px var(--cutout-shadow-dark);
    transition: all 0.3s ease;

    /* DIY Magazine Cutout aesthetic for social links */
    clip-path: polygon(
      20% 0%,
      80% 5%,
      95% 20%,
      100% 40%,
      95% 75%,
      85% 95%,
      60% 100%,
      25% 95%,
      5% 80%,
      0% 55%,
      5% 25%,
      15% 5%
    );
  }

  .social-link:hover {
    transform: translateY(-5px);
    box-shadow: 0 12px 24px var(--shadow-overlay-dark-medium);
    border-color: var(--naranja-comunidad);
  }

  .email-input {
    flex: 1;
    padding: var(--espacio-md);
    border: 2px solid var(--borde-claro);
    border-radius: 8px;
    font-size: 1rem;
  }

  .email-input:focus {
    outline: none;
    border-color: var(--naranja-comunidad);
  }

  @media (max-width: 768px) {
    .hero-comunidad h1 {
      font-size: 2rem;
    }

    .personas-grid {
      grid-template-columns: 1fr;
    }

    .persona-header {
      flex-direction: column;
      text-align: center;
    }

    .persona-avatar {
      margin: 0 auto;
    }
  }
</style>
