---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';

// eslint-disable-next-line @typescript-eslint/no-explicit-any
export async function getStaticPaths(): Promise<
  Array<{
    params: { slug: string };
    // eslint-disable-next-line @typescript-eslint/no-explicit-any
    props: { script: any };
  }>
> {
  const scripts = await getCollection('scripts');
  // eslint-disable-next-line @typescript-eslint/no-explicit-any
  return scripts.map((script: any) => ({
    params: { slug: script.id },
    props: { script },
  }));
}

interface Props {
  // eslint-disable-next-line @typescript-eslint/no-explicit-any
  script: any;
}

const { script }: Props = Astro.props;

if (script == null) {
  throw new Error('Script not found');
}

const { data } = script;
const titulo = data.titulo != null ? String(data.titulo) : 'Sin t√≠tulo';
const episodio = data.episodio != null ? String(data.episodio) : 'EP000';
const plataforma =
  data.plataforma != null ? String(data.plataforma) : 'Plataforma';
const duracion = data.duracion != null ? String(data.duracion) : 'N/A';
const body = script.body != null ? String(script.body) : '';

const pageTitle = `${titulo} - ${episodio}`;
const pageDescription = `Guion para ${plataforma}: ${titulo}. Duracion: ${duracion}.`;
---

<BaseLayout title={pageTitle} description={pageDescription}>
  <div class="container">
    <h1>{titulo}</h1>
    <p>Episodio: {episodio}</p>
    <p>Plataforma: {plataforma}</p>
    <div set:html={body} />
  </div>
</BaseLayout>
