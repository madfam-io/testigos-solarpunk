/**
 * Accessibility Fixes - WCAG AA Compliance
 * 
 * Global style overrides to fix color contrast issues
 * identified by Lighthouse CI audits.
 * 
 * Uses :global() to bypass Astro's scoped styles and ensure
 * consistent application regardless of generated data-astro-cid attributes.
 * 
 * These rules ensure all interactive elements meet or exceed
 * WCAG AA standards (4.5:1 for normal text, 3:1 for large text)
 */

/* =================================================================
 * Global Style Overrides for Astro Scoped Components
 * ================================================================= */

/* Use :global() to ensure styles apply regardless of Astro's scoping */
:global(html) {
  /* Button Link Color Inheritance Fixes */
  & :is(a.btn, .btn:is(a)) {
    &,
    &:link,
    &:visited,
    &:hover,
    &:focus,
    &:active {
      /* Block ALL link color inheritance */
      color: inherit !important;
    }
  }
}

/* Primary buttons - WCAG AA compliant contrast */
:global(.btn-primary),
:global(a.btn-primary),
:global(.btn.btn-primary) {
  color: #000000 !important;
  background-color: #ffc107 !important;

  &:hover,
  &:focus {
    color: #000000 !important;
    background-color: #ffca2c !important;
  }
}

/* Secondary buttons - Light theme */
:global(.btn-secondary),
:global(a.btn-secondary),
:global(.btn.btn-secondary) {
  color: #000000 !important;
  background-color: #e0e0e0 !important;

  &:hover,
  &:focus {
    color: #000000 !important;
    background-color: #d5d5d5 !important;
  }
}

/* Secondary buttons - Dark theme */
:global([data-theme='dark']) {
  :global(.btn-secondary),
  :global(a.btn-secondary),
  :global(.btn.btn-secondary) {
    background-color: #1b5e20 !important;
    color: #ffffff !important;

    &:hover,
    &:focus {
      background-color: #2e7d32 !important;
      color: #ffffff !important;
    }
  }
}

/* =================================================================
 * Phase Status Badge Contrast Fixes
 * ================================================================= */

/* Phase status badges - WCAG AA compliant colors */
:global(.fase-status) {
  filter: none !important;

  &:global(.active) {
    background-color: #1b5e20 !important; /* Very dark green - 7.54:1 ratio */
    color: #ffffff !important;
  }

  &:global(.upcoming) {
    background-color: #0d47a1 !important; /* Very dark blue - 8.59:1 ratio */
    color: #ffffff !important;
  }

  &:global(.development) {
    background-color: #bf360c !important; /* Very dark orange - 5.37:1 ratio */
    color: #ffffff !important;
  }
}

/* =================================================================
 * Magazine Card Theme Contrast Fixes
 * ================================================================= */

/* Magazine buttons - special styling buttons */
:global(.magazine-btn) {
  color: inherit !important;

  &:global(.primary) {
    color: #000000 !important;
    background-color: #ffc107 !important;
  }

  &:global(.secondary) {
    color: #000000 !important;
    background-color: #e0e0e0 !important;
  }
}

/* Dark theme magazine buttons */
:global([data-theme='dark']) {
  :global(.magazine-btn) {
    &:global(.primary) {
      color: #000000 !important;
      background-color: #ffc107 !important;
    }

    &:global(.secondary) {
      color: #ffffff !important;
      background-color: #1b5e20 !important;
    }
  }
}

/* Ensure all themed magazine cards have proper button contrast */
html body .magazine-card .btn,
html body .magazine-card a.btn,
html body .magazine-card.theme-solar .btn,
html body .magazine-card.theme-green .btn,
html body .magazine-card.theme-purple .btn,
html body .magazine-card.theme-community .btn,
html body .magazine-card.theme-tech .btn {
  /* These are handled by button rules above */
}

/* =================================================================
 * Additional Contrast Improvements
 * ================================================================= */

/* Ensure meta text has sufficient contrast */
:global(.character-meta),
:global(.meta-item),
:global(.text-muted) {
  color: #424242 !important; /* Dark gray - 9.73:1 on white */
}

:global([data-theme='dark']) {
  :global(.character-meta),
  :global(.meta-item),
  :global(.text-muted) {
    color: #e0e0e0 !important; /* Light gray - 12.63:1 on black */
  }
}

/* CTA Section text on dark backgrounds */
:global(.cta-section) :global(.text-muted) {
  color: #212121 !important; /* Very dark gray - 15.87:1 on light bg */
}

:global([data-theme='dark']) :global(.cta-section) :global(.text-muted) {
  color: #f5f5f5 !important; /* Very light gray - 18.1:1 on dark bg */
}

/* Card and description text */
:global(.card-description),
:global(.card) :global(p),
:global(.magazine-card) :global(p) {
  color: #212121 !important;
}

:global([data-theme='dark']) {
  :global(.card-description),
  :global(.card) :global(p),
  :global(.magazine-card) :global(p) {
    color: #f5f5f5 !important;
  }
}

/* Links - high contrast colors */
:global(a:not(.btn):not(.magazine-btn)) {
  color: #0d47a1 !important; /* Very dark blue - 8.59:1 on white */
  text-decoration: underline !important;

  &:hover,
  &:focus {
    color: #01579b !important; /* Even darker blue */
  }
}

:global([data-theme='dark']) :global(a:not(.btn):not(.magazine-btn)) {
  color: #64b5f6 !important; /* Light blue - 9.03:1 on black */

  &:hover,
  &:focus {
    color: #90caf9 !important;
  }
}

/* Footer links */
:global(footer) :global(a:not(.btn):not(.magazine-btn)) {
  color: #0d47a1 !important;
  text-decoration: underline !important;

  &:hover,
  &:focus {
    color: #01579b !important;
  }
}

:global([data-theme='dark'])
  :global(footer)
  :global(a:not(.btn):not(.magazine-btn)) {
  color: #ffd54f !important;

  &:hover,
  &:focus {
    color: #ffe082 !important;
  }
}

/* =================================================================
 * Paragraph and Text Contrast Improvements
 * ================================================================= */

/* General paragraph text */
:global(p) {
  color: #212121 !important; /* Very dark gray for better contrast */
}

:global([data-theme='dark']) :global(p) {
  color: #f5f5f5 !important; /* Very light gray for dark theme */
}

/* Hero text exceptions */
:global(p.hero-description),
:global(p.hero-subtitle) {
  color: inherit !important;
}

/* Content text */
:global(.text-content),
:global(.description),
:global(.card-text),
:global(.content) :global(p) {
  color: #212121 !important;
}

:global([data-theme='dark']) {
  :global(.text-content),
  :global(.description),
  :global(.card-text),
  :global(.content) :global(p) {
    color: #f5f5f5 !important;
  }
}

/* =================================================================
 * Specific Component Contrast Fixes
 * ================================================================= */

/* Phase card descriptions */
:global(.fase-card) :global(.fase-description),
:global(.fases-grid) :global(.fase-description) {
  color: #000000 !important;
  font-weight: 500 !important;
}

:global([data-theme='dark']) {
  :global(.fase-card) :global(.fase-description),
  :global(.fases-grid) :global(.fase-description) {
    color: #ffffff !important;
  }
}

/* Strategy flow text */
:global(.strategy-flow) :global(.flow-item) :global(p) {
  color: #000000 !important;
  font-weight: 500 !important;
}

:global([data-theme='dark'])
  :global(.strategy-flow)
  :global(.flow-item)
  :global(p) {
  color: #ffffff !important;
}

/* List links */
:global(ul) :global(li) :global(a:not(.btn):not(.magazine-btn)) {
  color: #0033cc !important;
  text-decoration: underline !important;
  font-weight: 500 !important;

  &:hover,
  &:focus {
    color: #002199 !important;
  }
}

:global([data-theme='dark'])
  :global(ul)
  :global(li)
  :global(a:not(.btn):not(.magazine-btn)) {
  color: #ffd54f !important;

  &:hover,
  &:focus {
    color: #ffe082 !important;
  }
}

/* Footer text */
:global(footer) :global(.text-center) :global(p) {
  color: #000000 !important;
  font-weight: 500 !important;
}

:global([data-theme='dark']) :global(footer) :global(.text-center) :global(p) {
  color: #ffffff !important;
}

/* Vision grid text */
:global(.vision-grid) :global(.vision-item) :global(p) {
  color: #000000 !important;
  font-weight: 500 !important;
}

:global([data-theme='dark'])
  :global(.vision-grid)
  :global(.vision-item)
  :global(p) {
  color: #ffffff !important;
}

/* =================================================================
 * Global Overrides for Astro Scoped Elements
 * ================================================================= */

/* Override any Astro scoped styles that might have contrast issues */
:global([class*='astro-']) :global(p),
:global([data-astro-cid]) {
  /* Ensure minimum contrast */
  color: #212121 !important;
}

:global([data-theme='dark']) {
  :global([class*='astro-']) :global(p),
  :global([data-astro-cid]) {
    color: #f5f5f5 !important;
  }
}

/* Character-specific text elements */
:global(.character-name) {
  /* Preserve brand color but ensure contrast */
  color: #4527a0 !important; /* Darker purple for better contrast */
}

:global([data-theme='dark']) :global(.character-name) {
  color: #9575cd !important; /* Lighter purple for dark theme */
}
